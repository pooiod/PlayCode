<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlayCode</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/material.min.css">
    <style>
        body {
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        .navbar {
            background-color: #333;
            color: white;
            padding: 1em;
            text-align: center;
        }
        .container {
            display: flex;
            flex: 1;
        }
        .big-box {
            flex: 1;
            background-color: #f0f0f0;
            padding: 0;
            display: flex;
            flex-direction: column;
        }
        .tab-navbar {
            display: flex;
            background-color: #444;
        }
        .tab {
            flex: 1;
            padding: 1em;
            text-align: center;
            color: white;
            cursor: pointer;
        }
        .tab:hover {
            background-color: #555;
        }
        .big-box-content {
            flex: 1;
            display: none;
        }
        .small-box {
            width: 300px;
            display: flex;
            flex-direction: column;
            background-color: #e0e0e0;
        }
        .top-box {
            height: 400px;
            background-color: #ccc;
        }
        .bottom-box {
            flex: 1;
            background-color: #bbb;
        }
        /* Prevent CodeMirror from resizing its container */
        .CodeMirror {
            height: 100%;
            overflow: auto; /* Add scrollbars if content overflows */
        }
    </style>
</head>
<body>
    <div class="navbar">Top Navbar</div>
    <div class="container">
        <div class="big-box">
            <div class="tab-navbar">
                <div class="tab" onclick="showTab('code')">Code</div>
                <div class="tab" onclick="showTab('tab2')">Tab 2</div>
                <div class="tab" onclick="showTab('tab3')">Tab 3</div>
            </div>
            <div id="code" class="big-box-content">
                <textarea id="codeEditor"></textarea>
            </div>
            <div id="tab2" class="big-box-content">Content for Tab 2</div>
            <div id="tab3" class="big-box-content">Content for Tab 3</div>
        </div>
        <div class="small-box">
            <div class="top-box">Top Box (400px)</div>
            <div class="bottom-box">Bottom Box</div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/lua/lua.min.js"></script>
    <script>
        function showTab(tabId) {
            document.querySelectorAll('.big-box-content').forEach(tab => {
                tab.style.display = 'none';
            });
            document.getElementById(tabId).style.display = 'block';

            if (tabId === 'code') {
                if (!window.codeMirrorInitialized) {
                    window.codeMirrorInitialized = true;
                    const editor = CodeMirror.fromTextArea(document.getElementById('codeEditor'), {
                        lineNumbers: true,
                        mode: 'lua',
                        theme: 'material',
                        lineWrapping: true,
                        viewportMargin: Infinity // Keeps the editor height stable
                    });
                    editor.setSize('100%', '100%');
                }
            }
        }
        // Show the code tab by default
        showTab('code');
    </script>
</body>
</html>
